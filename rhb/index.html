<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>RHB BANK</title>
<!-- Google Font: Lato -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap" rel="stylesheet">

<style>
  :root{
    --bg:#000000;
    --card:#edf1f6;
    --line:#e8edf4;
    --label:rgb(139,148,160);
    --text:rgb(66,75,87);
    --radius:10px;
    --chip:#e74c5e;           /* warna chip Auto */
    --chip-on:#5bc2e7;
  }
  *{box-sizing:border-box}
  html,body{margin:0}
  body{
    font-family:'Lato',system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
    background:var(--bg); color:var(--text); padding:24px;
  }

  .wrap{max-width:820px;margin:0 auto;display:grid;gap:18px}
  .card{background:var(--card);border:1px solid var(--line);border-radius:3px;box-shadow:0 1px 1px rgba(0,0,0,.02)}

  /* ----------- FORM ----------- */
  .form{padding:16px;display:grid;grid-template-columns:repeat(12,1fr);gap:12px 14px;background:#5bc2e7}
  .form h2{grid-column:1/-1;font-size:16px;font-weight:700;color:#0050a1;letter-spacing:.02em;margin:2px 0 6px;text-transform:uppercase}
  .fld{grid-column:span 6;min-width:0}
  .fld.w12{grid-column:1/-1}
  .lbl{display:block;font-size:14px;color:#fff;margin:2px 0 6px}

  .input-row{display:flex;gap:8px;align-items:center}
  .inp,.sel,.btn{height:40px;width: 100%;border:1px solid var(--line);background:#f9fbff;color:#0050a1;border-radius:8px;padding:0 12px;font-size:14px;outline:none}
  .inp{width:100%}
  .mini{height:40px;border-radius:10px;border:1px solid #fff;background:#fff;min-width:54px;padding:0 8px}
  .chip{
    border:none;min-width:58px;height:40px;border-radius:999px;
    color:#0050a1;background:#fff;padding:0 12px;font-weight:700;cursor:pointer
  }
  .chip.on{background:var(--chip-on);border:1px solid #fff;}
  .btn{background:#eef3fb;border-color:#dfe6f2;font-weight:600;cursor:pointer}
  .btn:hover{filter:brightness(.98)}
  .btn:active{transform:translateY(1px)}
  .btn-reset{background:#eef3fb;border-color:#dfe6f2;font-weight:600;cursor:pointer}
  .btn-reset:hover{filter:brightness(.98)}.btn-reset:active{transform:translateY(1px)}
  .btn-reset{height:40px;border:1px solid var(--line);width: 100%;background:#f9fbff;color:red;border-radius:8px;padding:0 12px;font-size:14px;outline:none}

  /* ----------- PREVIEW ----------- */
  .preview{padding:0;overflow:hidden}
  .row{display:flex;align-items:center;padding:18px;gap:10px;border-bottom:1.5px solid #fff;margin-bottom:15px}
  .preview .row:nth-child(2){border-bottom:none}
  .row:last-child{border-bottom:none}
  .to-label{font-size:12px;color:var(--label);margin-bottom:2px}
  .to-line{font-size:15px;color:var(--text);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
  .dot{padding:0 8px;color:#253041}
  .cols{display:grid;grid-template-columns:1fr 1fr;gap:28px;width:100%}
  .kv .k{font-size:14px;color:var(--label);margin-bottom:3px}
  .kv .v{font-size:16px;color:var(--text)}

  .blur{filter:blur(5px);opacity:.85;border-radius:6px;padding:0 .15em;display:inline-block}

  @media (max-width:640px){
    .fld{grid-column:1/-1}
    .cols{grid-template-columns:1fr}
    .row{padding:16px 14px}
    .mini{min-width:48px}
  }
  .zoom-wrap{
  transform: scale(1);        /* 120% */
  transform-origin: top center;  /* supaya membesar ke tengah, bukan ke bawah */
  margin-top: 20px;              /* beri ruang sedikit */
}
</style>
</head>
<body>
<div class="zoom-wrap">
  <div class="wrap">
  <!-- Form -->
  <div class="card form" id="form">
    <h2>RHB BANK</h2>

    <!-- NAME with Auto + A–Z + BIN/BINTI -->
    <div class="fld">
      <label class="lbl">To (Recipient Name)</label>
      <div class="input-row">
        <button type="button" class="chip" id="autoName">Auto</button>
        <select class="mini" id="letterSel" title="Huruf awal">
          <!-- A–Z -->
          <script>
            document.write(
              '<option value="">A–Z</option>'+
              'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('').map(l=>`<option>${l}</option>`).join('')
            );
          </script>
        </select>
        <select class="mini" id="binSel" title="BIN / BINTI">
          <option value="">-</option>
          <option value="BIN">BIN</option>
          <option value="BINTI">BINTI</option>
        </select>
        <input class="inp" id="toName" placeholder="MAMA & PAPA" value="I LOVE YOU">
      </div>
    </div>

    <!-- ACCOUNT -->
    <div class="fld">
      <label class="lbl">Recipient Account / ID</label>
      <div class="input-row">
        <button type="button" class="chip" id="autoAcct">Auto</button>
        <input class="inp" id="toId" placeholder="123456789">
      </div>
    </div>

    <!-- BANK + Auto -->
    <div class="fld">
      <label class="lbl">Bank</label>
      <div class="input-row">
        <button type="button" class="chip" id="autoBank">Auto</button>
        <select class="sel" id="bankSel" style="width:100%">
          <option>Touch N Go Digital</option>
          <option>Maybank</option>
          <option>CIMB</option>
          <option>Bank Simpanan Nasional</option>
          <option>Hong Leong Bank Berhad</option>
          <option>Public Bank</option>
          <option>Bank Kerjasama Rakyat Malaysia</option>
        </select>
      </div>
    </div>

    <div class="fld">
      <label class="lbl">Payment Type</label>
      <input class="inp" id="payType" value="Fund Transfer">
    </div>

    <div class="fld">
      <label class="lbl">Amount (MYR)</label>
      <input class="inp" id="amount" inputmode="decimal" placeholder="Amount" value="0.00">
    </div>

    <div class="fld">
      <label class="lbl">Recipient Reference</label>
      <input class="inp" id="reference" value="Payment" placeholder="Payment">
    </div>

<div class="fld w12" style="display:flex; gap:8px">
  <button class="btn-reset" id="resetBtn">Reset</button>
  <button class="btn" id="createBtn">Create</button>
</div>
  </div>

  <!-- Preview -->
  <div class="card preview" id="preview">
    <div class="row">
      <div>
        <div class="to-label">To</div>
        <div class="to-line" id="toLine"></div>
      </div>
    </div>

    <div class="row">
      <div class="cols" style="margin-top:2px">
        <div class="kv"><div class="k">Bank</div><div class="v" id="vBank">Touch N Go Digital</div></div>
        <div class="kv"><div class="k">Payment Type</div><div class="v" id="vType">Fund Transfer</div></div>
      </div>
    </div>

    <div class="row">
      <div class="cols">
        <div class="kv"><div class="k">Amount</div><div class="v" id="vAmount">MYR 0.00</div></div>
        <div class="kv"><div class="k">Recipient Reference</div><div class="v" id="vRef">Payment</div></div>
      </div>
    </div>
  </div>
</div>
</div>

<script>
const $ = s => document.querySelector(s);
const el = {
  toName: $('#toName'), toId: $('#toId'), bankSel: $('#bankSel'),
  payType: $('#payType'), amount: $('#amount'), ref: $('#reference'),
  toLine: $('#toLine'), vBank: $('#vBank'), vType: $('#vType'),
  vAmount: $('#vAmount'), vRef: $('#vRef'),
  createBtn: $('#createBtn'), resetBtn: $('#resetBtn'),
  autoName: $('#autoName'), autoBank: $('#autoBank'), autoAcct: $('#autoAcct'),
  letterSel: $('#letterSel'), binSel: $('#binSel')
};

/* ---------- Persist ke localStorage ---------- */
const STORAGE_KEY = 'blurMask.payment.v1';

function readState(){
  return {
    toName: el.toName.value,
    toId: el.toId.value,
    bankSel: el.bankSel.value,
    payType: el.payType.value,
    amount: el.amount.value,
    ref: el.ref.value,
    letterSel: el.letterSel.value,
    binSel: el.binSel.value,
    autoName: el.autoName.classList.contains('on'),
    autoBank: el.autoBank.classList.contains('on'),
    autoAcct: el.autoAcct.classList.contains('on')
  };
}
function saveState(){ try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(readState())); }catch{} }
function applyState(s){
  if(!s) return;
  el.toName.value = s.toName ?? el.toName.value;
  el.toId.value   = s.toId ?? el.toId.value;
  el.bankSel.value= s.bankSel ?? el.bankSel.value;
  el.payType.value= s.payType ?? el.payType.value;
  el.amount.value = s.amount ?? el.amount.value;
  el.ref.value    = s.ref ?? el.ref.value;
  el.letterSel.value = s.letterSel ?? el.letterSel.value;
  el.binSel.value    = s.binSel ?? el.binSel.value;

  [['autoName',s.autoName],['autoBank',s.autoBank],['autoAcct',s.autoAcct]].forEach(([k,on])=>{
    el[k].classList.toggle('on', !!on);
  });
}
function loadState(){
  try{ applyState(JSON.parse(localStorage.getItem(STORAGE_KEY) || 'null')); }catch{}
}
function resetAll(){
  localStorage.removeItem(STORAGE_KEY);
  el.toName.value = 'I LOVE YOU';
  el.toId.value   = '0';
  el.bankSel.value= 'Touch N Go Digital';
  el.payType.value= 'Fund Transfer';
  el.amount.value = '0.00';
  el.ref.value    = 'Payment';
  el.letterSel.value = '';
  el.binSel.value    = '';
  el.autoName.classList.remove('on');
  el.autoBank.classList.remove('on');
  el.autoAcct.classList.remove('on');
  render();
}

/* ---------- Helpers ---------- */
function fmtMYR(val){
  let num = Number(String(val).replace(/[^\d.]/g,'')); if(!isFinite(num)) num = 0;
  return 'MYR ' + num.toLocaleString('en-MY',{minimumFractionDigits:2,maximumFractionDigits:2});
}
function maskAccountKeepDashes(str){
  if (!str) return '';
  const raw = String(str), digits = raw.replace(/\D/g,'');
  let seen = 0, out = '';
  for (const ch of raw){
    if (/\d/.test(ch)){
      seen++;
      const isLastTwo = seen > (digits.length - 1);
      out += isLastTwo ? ch : `<span class="blur">${ch}</span>`;
    } else if (ch === '-') {
      out += `<span class="blur">-</span>`;  // blur tanda '-'
    } else {
      out += ch;
    }
  }
  return out;
}
function maskNameFirst2(name){
  if (!name) return '';
  const s = String(name).trim().toUpperCase();
  let shown = s.slice(0,1), masked = '';
  for (const ch of s.slice(1)) masked += (ch===' ')? ' ' : `<span class="blur">${ch}</span>`;
  return shown + masked;
}
function randomInt(min,max){return Math.floor(Math.random()*(max-min+1))+min}
function pick(arr){return arr[Math.floor(Math.random()*arr.length)]}
const ABC = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
function randWord(min=2,max=7,startLetter=''){
  const len = randomInt(min,max);
  let s = '';
  if (startLetter){ s += startLetter.toUpperCase(); for (let i=1;i<len;i++) s += ABC[randomInt(0,25)];
  } else { for (let i=0;i<len;i++) s += ABC[randomInt(0,25)]; }
  return s;
}
function makeRandomName(){
  const start = el.letterSel.value || '';
  const middle = Math.random()<0.5 ? randWord(2,4) : '';
  const connector = el.binSel.value || (Math.random()<0.5 ? 'BIN' : 'BINTI');
  const first = randWord(3,7,start);
  const last  = randWord(4,7);
  return (first + (middle? ' '+middle:'') + (connector? ' '+connector:'') + ' ' + last).trim();
}

/* Pola akaun per bank – PASTIKAN nilai <option> sama persis dengan key di sini */
const BANK_PATTERNS = {
  'Touch N Go Digital': [1,4,6,1],
  'Maybank':            [1,4,6,1],
  'CIMB':               [10],
  'Bank Simpanan Nasional':[1,5,7,3],
  'Hong Leong Bank Berhad':[11],
  'Public Bank':        [10],
  'Bank Kerjasama Rakyat Malaysia':[10],
  'Bank Islam':         [4,4,4],
  'AmBank':             [4,4,4],
  'OCBC Bank':          [4,4,4],
  'UOB Bank':           [4,4,4]
};
function genDigits(n){return Array.from({length:n},()=>String(randomInt(0,9))).join('')}
function makeAccountFor(bank){
  const groups = BANK_PATTERNS[bank] || [4,4,4];
  return groups.map(n=>genDigits(n)).join('-');
}

/* ---------- Render ---------- */
function render(){
  // auto toggles
  if (el.autoBank.classList.contains('on')){
    const options = Array.from(el.bankSel.options).map(o=>o.value);
    el.bankSel.value = pick(options);
  }
  if (el.autoAcct.classList.contains('on')){
    el.toId.value = makeAccountFor(el.bankSel.value);
  }
  if (el.autoName.classList.contains('on')){
    el.toName.value = makeRandomName();
  }

  // preview
  const nameFrag = maskNameFirst2(el.toName.value);
  const idFrag   = maskAccountKeepDashes(el.toId.value);
  el.toLine.innerHTML = `${nameFrag}<span class="dot">•</span>${idFrag}`;
  el.vBank.textContent = el.bankSel.value || '';
  el.vType.textContent = el.payType.value || '';
  el.vAmount.textContent = fmtMYR(el.amount.value);
  el.vRef.textContent = el.ref.value || '';
}

/* ---------- Listeners ---------- */
// angka -> bersihkan saat blur
el.amount.addEventListener('blur', e=>{
  e.target.value = String(Number(String(e.target.value).replace(/[^\d.]/g,''))||0);
});
// simpan + render saat ada perubahan
['input','change'].forEach(evt=>{
  [el.toName, el.toId, el.payType, el.amount, el.ref, el.bankSel, el.letterSel, el.binSel]
    .forEach(n => n.addEventListener(evt, ()=>{ saveState(); render(); }));
});
// klik chip auto
[el.autoName, el.autoBank, el.autoAcct].forEach(btn=>{
  btn.addEventListener('click', ()=>{ btn.classList.toggle('on'); saveState(); render(); });
});
// ganti bank → buat no akaun sesuai pola
el.bankSel.addEventListener('change', ()=>{
  el.toId.value = makeAccountFor(el.bankSel.value);
  saveState(); render();
});
// tombol
el.createBtn.addEventListener('click', ()=>{ render(); saveState(); });
el.resetBtn.addEventListener('click', resetAll);

/* ---------- Init ---------- */
loadState();   // ambil dari localStorage
render();      // lalu render tampilan
</script>
</body>
</html>
